<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<div th:replace="partials.html :: site-header"></div>

<!--<video id="video" width="640px" height="480px" autoplay></video>-->
<!--<button type="submit" id="snap">Take Photo</button>-->

<!--<canvas id="canvas" width="640px" height="480px"></canvas>-->

<!--<button type="submit" id="save-plant-photo">Save Plant</button>-->

<div class="spacer"></div>

<form th:action="@{/plants}" th:method="post">
	<input type="file" multiple>
	<input id="plantUrl" name="plantUrl" type="hidden" th:value="replaceme">
	<button type="button">Ok</button>
	<button type="submit">Finalize Upload</button>
</form>

<div id="plant" style="font-weight: bold; font-size: large; color: firebrick"></div>

<script>
	// // navigator.mediaDevices.enumerateDevices().then(devices => {
	// // 	console.log(devices)});
	//
	// let canvas = document.querySelector("#canvas");
	// let context = canvas.getContext('2d');
	// let video = document.querySelector("#video");
	//
	// //opens users camera if they allow
	// if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia){
	// 	navigator.mediaDevices.getUserMedia({video: true, sound: false}).then(stream => {
	// 		video.srcObject = stream;
	// 		video.play();
	// 		});
	// }
	//
	// //captures photo and displays on the canvas
	// document.getElementById("snap").addEventListener("click", () => {
	// 	context.drawImage(video, 0, 0, 640, 480);
	// });
	//
	// //saves photo
	// document.getElementById("save-plant-photo").addEventListener("click", ()=>{
	// 	// let newCanvas = document.createElement("canvas");
	// 	let dataURL = canvas.toDataURL('image/jpeg', 1.0);
	// 	// let newContext = newCanvas.getContext("2d");
	//
	// 	console.log(dataURL);
	//
	//
	// 	const promises = dataURL.map((file) => {
	// 		return new Promise((resolve, reject) => {
	// 			const reader = new FileReader();
	// 			reader.onload = (event) => {
	// 				const res = event.target.result;
	// 				console.log(res);
	// 				resolve(res);
	// 			}
	// 			reader.readAsDataURL(file)
	// 		})
	// 	})
	//
	// 	Promise.all(promises).then((base64files) => {
	// 		console.log(base64files)
	//
	// 		const data = {
	// 			api_key: plantIDAPI,
	// 			images: base64files,
	// 			modifiers: ["crops_fast", "similar_images"],
	// 			plant_language: "en",
	// 			plant_details: ["common_names",
	// 				"url",
	// 				"name_authority",
	// 				"wiki_description",
	// 				"taxonomy",
	// 				"synonyms"]
	// 		};
	//
	// 		fetch('https://api.plant.id/v2/identify', {
	// 			method: 'POST',
	// 			headers: {
	// 				'Content-Type': 'application/json',
	// 			},
	// 			body: JSON.stringify(data),
	// 		})
	// 		.then(response => response.json())
	// 		.then(data => {
	// 			console.log('Success:', data);
	// 			document.getElementById("plant").append(
	// 					data.suggestions[0].plant_details.common_names[0],
	// 			)
	// 			document.getElementById("plantUrl").append(
	// 					data.images[0].url,
	// 			)
	// 		})
	// 		.catch((error) => {
	// 			console.error('Error:', error);
	// 		});
	// 	})
	// 	// newCanvas.height = 480;
	// 	// newCanvas.width = 640;
	// 	//
	// 	// let imagebase64data = newCanvas.toDataURL("image/png");
	// 	// imagebase64data = imagebase64data.replace("data:image/png;base64,", "");
	// 	// $.ajax({
	// 	// 	type: 'post',
	// 	// 	url: '/HOME/UploadWebCamImage',
	// 	// 	data: '{ "imageData" : "' + imagebase64data + '" }',
	// 	// 	contentType: 'application/json; charset=utf-8',
	// 	// 	dataType: 'text',
	// 	// 	success: (out) => {
	// 	// 		console.log('image upload successful');
	// 	// 	}
	// 	// });
	// });
	//
	// // document.getElementById('#save-plant-photo').onclick = function sendIdentification() {
    // // const files = [...document.querySelector('input[type=file]').files];
    // // const promises = files.map((file) => {
    // //     return new Promise((resolve, reject) => {
    // //         const reader = new FileReader();
    // //         reader.onload = (event) => {
    // //             const res = event.target.result;
    // //             console.log(res);
    // //             resolve(res);
    // //         }
    // //         reader.readAsDataURL(file)
    // //     })
    // // })
	// //
    // // Promise.all(promises).then((base64files) => {
    // //     console.log(base64files)
	// //
    // //     const data = {
    // //         api_key: plantIDAPI,
    // //         images: base64files,
    // //         modifiers: ["crops_fast", "similar_images"],
    // //         plant_language: "en",
    // //         plant_details: ["common_names",
    // //             "url",
    // //             "name_authority",
    // //             "wiki_description",
    // //             "taxonomy",
    // //             "synonyms"]
    // //     };
	// //
    // //     fetch('https://api.plant.id/v2/identify', {
    // //         method: 'POST',
    // //         headers: {
    // //             'Content-Type': 'application/json',
    // //         },
    // //         body: JSON.stringify(data),
    // //     })
    // //         .then(response => response.json())
    // //         .then(data => {
    // //             console.log('Success:', data);
    // //             document.getElementById("plant").append(
    // //                 data.suggestions[0].plant_details.common_names[0],
    // //             )
    // //             document.getElementById("plantUrl").append(
    // //                 data.images[0].url,
    // //             )
    // //         })
    // //         .catch((error) => {
    // //             console.error('Error:', error);
    // //         });
    // // })
</script>

<div th:replace="partials.html :: site-scripts"></div>
</body>
</html>